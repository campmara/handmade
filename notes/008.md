# Day 008: Writing a Square Wave to DirectSound

## On vtables and methods

There is a catch to putting methods and virtual methods in your classes / structs. The difference with just a normal non-virtual function is Only syntactic. It forces that method to be local only to that object. Implicitly, the compiler will insert a *this pointer into your function in order to reference that structure's members under the hood. Casey says it's purely syntactic in C++!

With virtual, it's more complicated (and not just syntactic). Virtual causes the compiler to insert a vtable pointer to the object that lets the compiler look up the function pointers that it needs in order to resolve which function pointer that call corresponds to (based on what the object type was that called the function). Virtual functions hit the double indirection issue (where you are going to the location of one pointer which is then also a pointer to another location). This costs you performance every time you use virtual!!

*Zero Cost Abstractions* are language features that are purely syntactic and cost nothing to perform. Be aware of what these are in your language!

## `IDirectSoundBuffer8::Lock`

We are going to write our sound into the buffer, and when it's playing and gets to the end of the buffer, it will loop back to the beginning.

We need to lock a region of the buffer in order to write into it. It gives us back potentially two regions. One if we ask for less than the end of the buffer, and two for if the buffer circles back. We have to handle both cases (full buffer section or two portions of it).